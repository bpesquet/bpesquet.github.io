<!doctype html><html><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><title>Entity Framework Core</title><link rel=stylesheet href=https://www.bpesquet.fr/reveal.js/dist/reveal.css><link rel=stylesheet href=https://www.bpesquet.fr/reveal.js/dist/theme/white.css></head><body><div class=reveal><div class=slides><section><h1>Entity Framework Core</h1><p><a href=https://ensc.bordeaux-inp.fr>Ecole Nationale Supérieure de Cognitique</a></p><p><a href=https://www.bpesquet.fr>Baptiste Pesquet</a></p></section><section><h2 id=sommaire>Sommaire
<span><a href=#sommaire><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg></a></span></h2><ul><li>Des objets et des tables</li><li>Présentation d&rsquo;EF Core</li><li>Mise en oeuvre d&rsquo;EF Core</li><li>Mapping d&rsquo;un modèle métier</li></ul></section><section><h2 id=des-objets-et-des-tables>Des objets et des tables
<span><a href=#des-objets-et-des-tables><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg></a></span></h2></section><section><h3 id=les-données-persistantes>Les données persistantes
<span><a href=#les-donn%c3%a9es-persistantes><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg></a></span></h3><ul><li>Ne disparaissent pas entre deux utilisations d&rsquo;une application.</li><li>Contraire : données <em>volatiles</em>.</li><li>Indispensable pour une très grande majorité des applications (données métier, configuration, etc).</li><li>Leur stockage nécessite :<ul><li>un support dédié, appelé parfois mémoire de masse (disque dur, SSD, mémoire Flash, etc) ;</li><li>un format adapté.</li></ul></li></ul></section><section><h3 id=les-sgbdr-et-leurs-avantages>Les SGBDR et leurs avantages
<span><a href=#les-sgbdr-et-leurs-avantages><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg></a></span></h3><ul><li>Standard actuel pour la gestion de données persistantes.</li><li>Technologie connue depuis les années 1970.</li><li>Fiabilité.</li><li>Capacité à gérer de forts volumes de données.</li><li>Sécurité (authentification, réplication, etc).</li><li>Langage d’interrogation (SQL) standard.</li><li>Offre logicielle riche : de ORACLE à SQLite en passant par PostgreSQL, MySQL/MariaDB ou SQL Server.</li></ul></section><section><h3 id=le-modèle-relationnel>Le modèle relationnel
<span><a href=#le-mod%c3%a8le-relationnel><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg></a></span></h3><ul><li>Unité de représentation : table.</li><li>Caractéristiques : colonnes.</li><li>Entité : tuple (ligne).</li><li>Types de données : simples (nombres, chaîne, date, etc).</li><li>Identifiant : explicite (clé primaire).</li><li>Relations entre éléments : jointures SQL.</li><li>Concepts spécifiques : déclencheurs, procédures stockées&mldr;</li></ul></section><section><h3 id=le-modèle-objet>Le modèle objet
<span><a href=#le-mod%c3%a8le-objet><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg></a></span></h3><ul><li>Unité de représentation : classe.</li><li>Caractéristiques : propriétés et méthodes.</li><li>Entité : objet.</li><li>Types de données : simples ou complexes.</li><li>Identifiant : implicite (référence mémoire).</li><li>Relations entre éléments : navigation des associations.</li><li>Concepts spécifiques : encapsulation, héritage, interfaces&mldr;</li></ul></section><section><section data-shortcode-section><h3 id=objectrelational-mapping-orm>Object/Relational Mapping (O/RM)
<span><a href=#objectrelational-mapping-orm><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg></a></span></h3><ul><li>Lien entre une base de données et les objets manipulés par l’application.</li><li>Deux modèles très éloignés ("<a href=https://en.wikipedia.org/wiki/Object%E2%80%93relational_impedance_mismatch>Impedance mismatch</a>").</li><li>Pas de solution idéale.</li></ul></section><section><h3 id=orm-is-the-vietnam-of-computer-sciencehttpsblogcodinghorrorcomobject-relational-mapping-is-the-vietnam-of-computer-science><a href=https://blog.codinghorror.com/object-relational-mapping-is-the-vietnam-of-computer-science/>&ldquo;O/RM is the Vietnam of Computer Science&rdquo;</a>
<span><a href=#orm-is-the-vietnam-of-computer-sciencehttpsblogcodinghorrorcomobject-relational-mapping-is-the-vietnam-of-computer-science><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg></a></span></h3><p><img src=images/orm_vietnam.png alt="Welcome to the jungle!"></p></section></section><section><h3 id=solutions-possibles-pour-lorm>Solutions possibles pour l&rsquo;O/RM
<span><a href=#solutions-possibles-pour-lorm><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg></a></span></h3><ul><li>Approches radicales : suppression du SGBDR (utilisation d&rsquo;une autre technologie de stockage) ou des objets (programmation procédurale ou fonctionnelle).</li><li>O/RM manuel : gestion de la (dé)connexion, requêtage avec SQL puis transformation des résultats en objets, etc doivent être codées.</li><li>O/RM automatisé : utilisation d&rsquo;un outil dédié pour gérer les problématiques précédentes. Le requêtage SQL est effectué par l&rsquo;outil.</li></ul></section><section><h3 id=orm-automatisé-un-bon-choix->O/RM automatisé, un bon choix ?
<span><a href=#orm-automatis%c3%a9-un-bon-choix-><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg></a></span></h3><ul><li>Avantages :<ul><li>Automatisation de la gestion du <em>mapping</em>.</li><li>Diminution du volume de code.</li><li>Mise en œuvre de bonnes pratiques.</li><li>Performances (le plus souvent).</li></ul></li><li>Inconvénients :<ul><li>Nécessité de maitriser un outil dédié.</li><li>Certaines limitations liées à l’outil.</li><li>Aspect &ldquo;boîte noire&rdquo;.</li><li>Performances (dans certains cas).</li></ul></li></ul></section><section><h2 id=présentation-def-core>Présentation d&rsquo;EF Core
<span><a href=#pr%c3%a9sentation-def-core><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg></a></span></h2></section><section><h3 id=entity-framework-core>Entity Framework Core
<span><a href=#entity-framework-core><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg></a></span></h3><ul><li>Outil d&rsquo;O/RM <a href=https://github.com/dotnet/efcore>open source</a> maintenu par Microsoft.</li><li>Supporte de nombreux SGDBR : SQL Server, SQLite, MySQL/MariaDB, PostgreSQL, etc.</li><li>Standard pour l&rsquo;accès aux données persistantes dans l&rsquo;environnement ASP.NET Core.</li></ul></section><section><h3 id=sqlite>SQLite
<span><a href=#sqlite><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg></a></span></h3><ul><li>SGBDR minimaliste mais suffisamment fiable, complet et performant pour la plupart des usages standards.</li><li>Toute la base de données tient dans un seul fichier de quelques dizaines/centaines de Ko.</li><li><a href=https://sqlite.org/mostdeployed.html>&ldquo;Le SGBD le plus utilisé dans le monde&rdquo;</a>.</li></ul><p><a href=https://sqlite.org><img src=images/sqlite370_banner.gif alt="Logo SQLite"></a></p></section><section><h3 id=installation-def-core-pour-sqlite>Installation d&rsquo;EF Core pour SQLite
<span><a href=#installation-def-core-pour-sqlite><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg></a></span></h3><p>Installation globale de l&rsquo;outil EF Core CLI :</p><p><code>> dotnet tool install --global dotnet-ef</code></p><p>Installation des packages nécessaires dans le répertoire du projet :</p><p><code>> dotnet add package Microsoft.EntityFrameworkCore.Design</code></p><p><code>> dotnet add package Microsoft.EntityFrameworkCore.Sqlite</code></p></section><section><h3 id=support-de-sqlite-par-ef-core>Support de SQLite par EF Core
<span><a href=#support-de-sqlite-par-ef-core><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg></a></span></h3><ul><li>Des <a href="https://docs.microsoft.com/en-us/ef/core/providers/?tabs=dotnet-core-cli">fournisseurs de données</a> permettent l&rsquo;utilisation de EF Core avec un grand nombre de sources de données, dont SQLite.</li><li>Son fournisseur possède cependant certaines petites <a href=https://docs.microsoft.com/en-us/ef/core/providers/sqlite/limitations>limitations</a>.</li></ul></section><section><h3 id=principe-de-fonctionnement-def-core>Principe de fonctionnement d&rsquo;EF Core
<span><a href=#principe-de-fonctionnement-def-core><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg></a></span></h3><ul><li><strong>Modèle</strong> : un ensemble de classes POCO, parfois appelées <em>classes métier</em>, qui modélisent les entités manipulées par l&rsquo;application.</li><li><strong>Contexte BD</strong> : une classe héritant de <code>DbContext</code> qui représente une session d&rsquo;échanges (lecture/écriture de données) avec une BD. Elle spécifie les classes du modèle à synchroniser avec la BD.</li><li><strong>BD</strong> : la base de données dans laquelle les instances du modèle sont lues/écrites.</li></ul></section><section><h3 id=migrations>Migrations
<span><a href=#migrations><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg></a></span></h3><ul><li>Approche <em><strong>code first</strong></em> : le modèle objet constitue la modélisation de référence. La base de données est automatiquement synchronisée avec lui.</li><li><a href="https://docs.microsoft.com/en-us/ef/core/managing-schemas/migrations/?tabs=dotnet-core-cli">Migrations</a> : modifications incrémentales du schéma relationnel reflétant les évolutions du modèle.</li></ul></section><section><h3 id=commandes-liées-aux-migrations>Commandes liées aux migrations
<span><a href=#commandes-li%c3%a9es-aux-migrations><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg></a></span></h3><p><code>> dotnet ef migrations add {MigrationName}</code></p><p>Crée une nouvelle migration dans le répertoire <strong>Migrations/</strong> du projet. Elle contient les mises à jour à réaliser au niveau du schéma relationnel pour le synchroniser avec le modèle objet.</p><p><code>> dotnet ef database update</code></p><p>Synchronise la base de données configurée par le contexte BD avec la migration la plus récente.</p></section><section><h3 id=interactions-avec-la-bd>Interactions avec la BD
<span><a href=#interactions-avec-la-bd><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg></a></span></h3><ul><li>L&rsquo;instanciation d&rsquo;un contexte BD permet de débuter une session de travail avec la base de données.</li><li>Sa méthode <code>SaveChanges()</code> implante dans la BD tous les changements ayant eu lieu depuis l&rsquo;ouverture de la session.</li></ul><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#fb660a;font-weight:700>using</span> (<span style=color:#cdcaa9;font-weight:700>var</span> context = <span style=color:#fb660a;font-weight:700>new</span> {App}Context())
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#080;background-color:#0f140f;font-style:italic>// ... (Opérations on model classes)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#080;background-color:#0f140f;font-style:italic>// Synchronize all changes with database</span>
</span></span><span style=display:flex><span>    context.SaveChanges();
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></section><section><h2 id=mise-en-oeuvre-def-core>Mise en oeuvre d&rsquo;EF Core
<span><a href=#mise-en-oeuvre-def-core><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg></a></span></h2></section><section><h3 id=exemple-de-modèle-métier>Exemple de modèle métier
<span><a href=#exemple-de-mod%c3%a8le-m%c3%a9tier><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg></a></span></h3><p><img src=images/efcore_blog_uml.png alt="Exemple de modèle EF Core"></p></section><section><h3 id=création-de-lapplication>Création de l&rsquo;application
<span><a href=#cr%c3%a9ation-de-lapplication><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg></a></span></h3><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>dotnet new console -o {AppName}
</span></span><span style=display:flex><span>cd {AppName}
</span></span><span style=display:flex><span>dotnet new gitignore
</span></span><span style=display:flex><span>dotnet add package Microsoft.EntityFrameworkCore.Design
</span></span><span style=display:flex><span>dotnet add package Microsoft.EntityFrameworkCore.Sqlite
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csproj data-lang=csproj><span style=display:flex><span><span style=color:#fb660a;font-weight:700>&lt;Project</span> <span style=color:#ff0086;font-weight:700>Sdk=</span><span style=color:#0086d2>&#34;Microsoft.NET.Sdk&#34;</span><span style=color:#fb660a;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#fb660a;font-weight:700>&lt;PropertyGroup&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#fb660a;font-weight:700>&lt;OutputType&gt;</span>Exe<span style=color:#fb660a;font-weight:700>&lt;/OutputType&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#fb660a;font-weight:700>&lt;TargetFramework&gt;</span>net6.0<span style=color:#fb660a;font-weight:700>&lt;/TargetFramework&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#fb660a;font-weight:700>&lt;ImplicitUsings&gt;</span>enable<span style=color:#fb660a;font-weight:700>&lt;/ImplicitUsings&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#fb660a;font-weight:700>&lt;Nullable&gt;</span>disable<span style=color:#fb660a;font-weight:700>&lt;/Nullable&gt;</span> <span style=color:#080;background-color:#0f140f;font-style:italic>&lt;!-- A MODIFIER --&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#fb660a;font-weight:700>&lt;/PropertyGroup&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#fb660a;font-weight:700>&lt;ItemGroup&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#fb660a;font-weight:700>&lt;PackageReference</span> <span style=color:#ff0086;font-weight:700>Include=</span><span style=color:#0086d2>&#34;Microsoft.EntityFrameworkCore.Design&#34;</span> <span style=color:#ff0086;font-weight:700>Version=</span><span style=color:#0086d2>&#34;6.0.9&#34;</span><span style=color:#fb660a;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#fb660a;font-weight:700>&lt;IncludeAssets&gt;</span>runtime; build; native; contentfiles; analyzers; buildtransitive<span style=color:#fb660a;font-weight:700>&lt;/IncludeAssets&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#fb660a;font-weight:700>&lt;PrivateAssets&gt;</span>all<span style=color:#fb660a;font-weight:700>&lt;/PrivateAssets&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#fb660a;font-weight:700>&lt;/PackageReference&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#fb660a;font-weight:700>&lt;PackageReference</span> <span style=color:#ff0086;font-weight:700>Include=</span><span style=color:#0086d2>&#34;Microsoft.EntityFrameworkCore.Sqlite&#34;</span> <span style=color:#ff0086;font-weight:700>Version=</span><span style=color:#0086d2>&#34;6.0.9&#34;</span> <span style=color:#fb660a;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#fb660a;font-weight:700>&lt;/ItemGroup&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#fb660a;font-weight:700>&lt;/Project&gt;</span>
</span></span></code></pre></div></section><section><h3 id=implémentation-du-modèle>Implémentation du modèle
<span><a href=#impl%c3%a9mentation-du-mod%c3%a8le><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg></a></span></h3><p>Chaque classe est codée dans son propre fichier <code>.cs</code>, dans le sous-répertoire <code>Models/</code> du projet.</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#fb660a;font-weight:700>public</span> <span style=color:#fb660a;font-weight:700>class</span> Blog
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#fb660a;font-weight:700>public</span> <span style=color:#cdcaa9;font-weight:700>int</span> Id { <span style=color:#fb660a;font-weight:700>get</span>; <span style=color:#fb660a;font-weight:700>set</span>; }
</span></span><span style=display:flex><span>    <span style=color:#fb660a;font-weight:700>public</span> <span style=color:#cdcaa9;font-weight:700>string</span> Url { <span style=color:#fb660a;font-weight:700>get</span>; <span style=color:#fb660a;font-weight:700>set</span>; }
</span></span><span style=display:flex><span>    <span style=color:#fb660a;font-weight:700>public</span> List&lt;Post&gt; Posts { <span style=color:#fb660a;font-weight:700>get</span>; } = <span style=color:#fb660a;font-weight:700>new</span> List&lt;Post&gt;();
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#fb660a;font-weight:700>public</span> <span style=color:#fb660a;font-weight:700>class</span> Post
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#fb660a;font-weight:700>public</span> <span style=color:#cdcaa9;font-weight:700>int</span> Id { <span style=color:#fb660a;font-weight:700>get</span>; <span style=color:#fb660a;font-weight:700>set</span>; }
</span></span><span style=display:flex><span>    <span style=color:#fb660a;font-weight:700>public</span> <span style=color:#cdcaa9;font-weight:700>string</span> Title { <span style=color:#fb660a;font-weight:700>get</span>; <span style=color:#fb660a;font-weight:700>set</span>; }
</span></span><span style=display:flex><span>    <span style=color:#fb660a;font-weight:700>public</span> <span style=color:#cdcaa9;font-weight:700>string</span> Content { <span style=color:#fb660a;font-weight:700>get</span>; <span style=color:#fb660a;font-weight:700>set</span>; }
</span></span><span style=display:flex><span>    <span style=color:#fb660a;font-weight:700>public</span> <span style=color:#cdcaa9;font-weight:700>int</span> BlogId { <span style=color:#fb660a;font-weight:700>get</span>; <span style=color:#fb660a;font-weight:700>set</span>; }
</span></span><span style=display:flex><span>    <span style=color:#fb660a;font-weight:700>public</span> Blog Blog { <span style=color:#fb660a;font-weight:700>get</span>; <span style=color:#fb660a;font-weight:700>set</span>; }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></section><section><h3 id=création-du-contexte-bd>Création du contexte BD
<span><a href=#cr%c3%a9ation-du-contexte-bd><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg></a></span></h3><p>Classe créée dans le sous-répertoire <code>Data/</code> du projet.</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#fb660a;font-weight:700>using</span> Microsoft.EntityFrameworkCore;
</span></span><span style=display:flex><span><span style=color:#fb660a;font-weight:700>using</span> Microsoft.Extensions.Logging;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#fb660a;font-weight:700>public</span> <span style=color:#fb660a;font-weight:700>class</span> BloggingContext : DbContext
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#fb660a;font-weight:700>public</span> DbSet&lt;Blog&gt; Blogs { <span style=color:#fb660a;font-weight:700>get</span>; <span style=color:#fb660a;font-weight:700>set</span>; }
</span></span><span style=display:flex><span>    <span style=color:#fb660a;font-weight:700>public</span> DbSet&lt;Post&gt; Posts { <span style=color:#fb660a;font-weight:700>get</span>; <span style=color:#fb660a;font-weight:700>set</span>; }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#fb660a;font-weight:700>public</span> <span style=color:#cdcaa9;font-weight:700>string</span> DbPath { <span style=color:#fb660a;font-weight:700>get</span>; <span style=color:#fb660a;font-weight:700>private</span> <span style=color:#fb660a;font-weight:700>set</span>; }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#fb660a;font-weight:700>public</span> BloggingContext()
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#080;background-color:#0f140f;font-style:italic>// Path to SQLite database file</span>
</span></span><span style=display:flex><span>        DbPath = <span style=color:#0086d2>&#34;EFGetStarted.db&#34;</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#080;background-color:#0f140f;font-style:italic>// The following configures EF to create a SQLite database file locally</span>
</span></span><span style=display:flex><span>    <span style=color:#fb660a;font-weight:700>protected</span> <span style=color:#fb660a;font-weight:700>override</span> <span style=color:#fb660a;font-weight:700>void</span> OnConfiguring(DbContextOptionsBuilder options)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#080;background-color:#0f140f;font-style:italic>// Use SQLite as database</span>
</span></span><span style=display:flex><span>        options.UseSqlite(<span style=color:#0086d2>$&#34;Data Source={DbPath}&#34;</span>);
</span></span><span style=display:flex><span>        <span style=color:#080;background-color:#0f140f;font-style:italic>// Optional: log SQL queries to console</span>
</span></span><span style=display:flex><span>        options.LogTo(Console.WriteLine, <span style=color:#fb660a;font-weight:700>new</span>[] { DbLoggerCategory.Database.Command.Name }, LogLevel.Information);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></section><section><h3 id=initialisation-de-la-base-de-données>Initialisation de la base de données
<span><a href=#initialisation-de-la-base-de-donn%c3%a9es><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg></a></span></h3><p>(<code>dotnet-ef</code> doit avoir été installé globalement)</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>dotnet ef migrations add InitialCreate
</span></span><span style=display:flex><span>dotnet ef database update
</span></span></code></pre></div></section><section><h3 id=extrait-de-la-migration-créée>Extrait de la migration créée
<span><a href=#extrait-de-la-migration-cr%c3%a9%c3%a9e><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg></a></span></h3><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>migrationBuilder.CreateTable(
</span></span><span style=display:flex><span>    name: <span style=color:#0086d2>&#34;Blogs&#34;</span>,
</span></span><span style=display:flex><span>    columns: table =&gt; <span style=color:#fb660a;font-weight:700>new</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        Id = table.Column&lt;<span style=color:#cdcaa9;font-weight:700>int</span>&gt;(type: <span style=color:#0086d2>&#34;INTEGER&#34;</span>, nullable: <span style=color:#fb660a;font-weight:700>false</span>)
</span></span><span style=display:flex><span>            .Annotation(<span style=color:#0086d2>&#34;Sqlite:Autoincrement&#34;</span>, <span style=color:#fb660a;font-weight:700>true</span>),
</span></span><span style=display:flex><span>        Url = table.Column&lt;<span style=color:#cdcaa9;font-weight:700>string</span>&gt;(type: <span style=color:#0086d2>&#34;TEXT&#34;</span>, nullable: <span style=color:#fb660a;font-weight:700>true</span>)
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    constraints: table =&gt;
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        table.PrimaryKey(<span style=color:#0086d2>&#34;PK_Blogs&#34;</span>, x =&gt; x.Id);
</span></span><span style=display:flex><span>    });
</span></span></code></pre></div></section><section><h3 id=base-de-données-créée>Base de données créée
<span><a href=#base-de-donn%c3%a9es-cr%c3%a9%c3%a9e><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg></a></span></h3><p>Capture d&rsquo;écran de <a href=https://sqlitebrowser.org/>DB Browser pour SQLite</a> :</p><p><img src=images/efcore_blog_schema.png alt="Schéma BD généré par EF Core"></p><p>La colonne <code>BlogId</code> est une clé étrangère vers la colonne <code>Id</code> de la table <code>Blogs</code>.</p></section><section><h3 id=structure-de-lapplication>Structure de l&rsquo;application
<span><a href=#structure-de-lapplication><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg></a></span></h3><p><a href=https://github.com/ensc-glog/EFGetStarted>https://github.com/ensc-glog/EFGetStarted</a></p><p><img src=images/efcore-efgetstarted.png alt="Structure de l&amp;rsquo;application d&amp;rsquo;exemple"></p></section><section><h3 id=opérations-crud>Opérations CRUD
<span><a href=#op%c3%a9rations-crud><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg></a></span></h3><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#fb660a;font-weight:700>using</span> (<span style=color:#cdcaa9;font-weight:700>var</span> context = <span style=color:#fb660a;font-weight:700>new</span> BloggingContext())
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    Console.WriteLine(<span style=color:#0086d2>&#34;--- Inserting a new blog ---&#34;</span>);
</span></span><span style=display:flex><span>    context.Add(<span style=color:#fb660a;font-weight:700>new</span> Blog { Url = <span style=color:#0086d2>&#34;http://blogs.msdn.com/adonet&#34;</span> });
</span></span><span style=display:flex><span>    context.SaveChanges();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Console.WriteLine(<span style=color:#0086d2>&#34;--- Retrieve blog with lowest id ---&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#cdcaa9;font-weight:700>var</span> blog = context.Blogs
</span></span><span style=display:flex><span>        .OrderBy(b =&gt; b.Id)
</span></span><span style=display:flex><span>        .First();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Console.WriteLine(<span style=color:#0086d2>&#34;--- Updating the blog and adding a post ---&#34;</span>);
</span></span><span style=display:flex><span>    blog.Url = <span style=color:#0086d2>&#34;https://devblogs.microsoft.com/dotnet&#34;</span>;
</span></span><span style=display:flex><span>    blog.Posts.Add(
</span></span><span style=display:flex><span>        <span style=color:#fb660a;font-weight:700>new</span> Post { Title = <span style=color:#0086d2>&#34;Hello World&#34;</span>, Content = <span style=color:#0086d2>&#34;I wrote an app using EF Core!&#34;</span> });
</span></span><span style=display:flex><span>    context.SaveChanges();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Console.WriteLine(<span style=color:#0086d2>&#34;--- Deleting the blog ---&#34;</span>);
</span></span><span style=display:flex><span>    context.Remove(blog);
</span></span><span style=display:flex><span>    context.SaveChanges();
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></section><section><h3 id=requêtage-avec-linq>Requêtage avec LINQ
<span><a href=#requ%c3%aatage-avec-linq><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg></a></span></h3><p><a href=https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/concepts/linq/>Language Integrated Query (LINQ)</a> est le langage standard pour le requêtage en C#, quelle que soit la source de données (SGBDR, XML, service web, etc).</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#fb660a;font-weight:700>using</span> (<span style=color:#cdcaa9;font-weight:700>var</span> context = <span style=color:#fb660a;font-weight:700>new</span> BloggingContext())
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#080;background-color:#0f140f;font-style:italic>// Retrieve a list of blogs with a rating greater than 3,</span>
</span></span><span style=display:flex><span>    <span style=color:#080;background-color:#0f140f;font-style:italic>// ordered by URL</span>
</span></span><span style=display:flex><span>    <span style=color:#cdcaa9;font-weight:700>var</span> blogs = context.Blogs
</span></span><span style=display:flex><span>        .Where(b =&gt; b.Rating &gt; <span style=color:#0086f7;font-weight:700>3</span>)
</span></span><span style=display:flex><span>        .OrderBy(b =&gt; b.Url)
</span></span><span style=display:flex><span>        .ToList();
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></section><section><h3 id=exemples-dutilisation-de-linq>Exemples d&rsquo;utilisation de LINQ
<span><a href=#exemples-dutilisation-de-linq><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg></a></span></h3><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#fb660a;font-weight:700>using</span> (<span style=color:#cdcaa9;font-weight:700>var</span> context = <span style=color:#fb660a;font-weight:700>new</span> BloggingContext())
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#080;background-color:#0f140f;font-style:italic>// Get all blogs</span>
</span></span><span style=display:flex><span>    <span style=color:#cdcaa9;font-weight:700>var</span> blogs = context.Blogs.ToList();
</span></span><span style=display:flex><span>    <span style=color:#080;background-color:#0f140f;font-style:italic>// Get the blog with id 1</span>
</span></span><span style=display:flex><span>    <span style=color:#cdcaa9;font-weight:700>var</span> blog = context.Blogs
</span></span><span style=display:flex><span>        .Single(b =&gt; b.Id == <span style=color:#0086f7;font-weight:700>1</span>);
</span></span><span style=display:flex><span>    <span style=color:#080;background-color:#0f140f;font-style:italic>// Get all blogs containing &#34;dotnet&#34; in their URL</span>
</span></span><span style=display:flex><span>    <span style=color:#cdcaa9;font-weight:700>var</span> blogs = context.Blogs
</span></span><span style=display:flex><span>        .Where(b =&gt; b.Url.Contains(<span style=color:#0086d2>&#34;dotnet&#34;</span>))
</span></span><span style=display:flex><span>        .ToList();
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Plus de détails :</p><ul><li><a href=https://docs.microsoft.com/en-us/ef/core/querying/>Querying data</a></li><li><a href=https://learn.microsoft.com/en-us/dotnet/csharp/programming-guide/concepts/linq/basic-linq-query-operations>Basic LINQ Query Operations</a></li></ul></section><section><h3 id=syntaxe-alternative-pour-linq>Syntaxe alternative pour LINQ
<span><a href=#syntaxe-alternative-pour-linq><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg></a></span></h3><p>Pour plus de souplesse, il est possible de manipuler des requêtes LINQ en tant que variables.</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#fb660a;font-weight:700>using</span> (<span style=color:#cdcaa9;font-weight:700>var</span> context = <span style=color:#fb660a;font-weight:700>new</span> BloggingContext())
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#080;background-color:#0f140f;font-style:italic>// Get all blogs containing &#34;dotnet&#34; in their URL</span>
</span></span><span style=display:flex><span>    <span style=color:#cdcaa9;font-weight:700>var</span> query = <span style=color:#fb660a;font-weight:700>from</span> b <span style=color:#fb660a;font-weight:700>in</span> context.Blogs
</span></span><span style=display:flex><span>                <span style=color:#fb660a;font-weight:700>select</span> b;
</span></span><span style=display:flex><span>    query = query.Where(b =&gt; b.Url.Contains(<span style=color:#0086d2>&#34;dotnet&#34;</span>));
</span></span><span style=display:flex><span>    <span style=color:#cdcaa9;font-weight:700>var</span> blogs = query.ToList();
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></section><section><h2 id=mapping-dun-modèle-métier>Mapping d&rsquo;un modèle métier
<span><a href=#mapping-dun-mod%c3%a8le-m%c3%a9tier><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg></a></span></h2></section><section><h3 id=configuration-du-modèle>Configuration du modèle
<span><a href=#configuration-du-mod%c3%a8le><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg></a></span></h3><p>Effectuée via des <a href="https://docs.microsoft.com/en-us/ef/core/modeling/entity-properties?tabs=data-annotations%2Cwithout-nrt">annotations</a> dans les classes du modèle.</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#fb660a;font-weight:700>public</span> <span style=color:#fb660a;font-weight:700>class</span> Blog
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#fb660a;font-weight:700>public</span> <span style=color:#cdcaa9;font-weight:700>int</span> Id { <span style=color:#fb660a;font-weight:700>get</span>; <span style=color:#fb660a;font-weight:700>set</span>; }
</span></span><span style=display:flex><span><span style=color:#ff0086;font-weight:700>
</span></span></span><span style=display:flex><span><span style=color:#ff0086;font-weight:700>    [StringLength(200, MinimumLength = 7), Required]</span>
</span></span><span style=display:flex><span>    <span style=color:#fb660a;font-weight:700>public</span> <span style=color:#cdcaa9;font-weight:700>string</span> Url { <span style=color:#fb660a;font-weight:700>get</span>; <span style=color:#fb660a;font-weight:700>set</span>; }
</span></span><span style=display:flex><span><span style=color:#ff0086;font-weight:700>
</span></span></span><span style=display:flex><span><span style=color:#ff0086;font-weight:700>    [Display(Name = &#34;Average Rating&#34;)]</span>
</span></span><span style=display:flex><span><span style=color:#ff0086;font-weight:700>    [Column(TypeName = &#34;decimal(5, 2)&#34;)]</span>
</span></span><span style=display:flex><span><span style=color:#ff0086;font-weight:700>    [DisplayFormat(NullDisplayText = &#34;No rating&#34;)]</span>
</span></span><span style=display:flex><span>    <span style=color:#fb660a;font-weight:700>public</span> <span style=color:#cdcaa9;font-weight:700>decimal?</span> Rating { <span style=color:#fb660a;font-weight:700>get</span>; <span style=color:#fb660a;font-weight:700>set</span>; }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#080;background-color:#0f140f;font-style:italic>// ...</span>
</span></span></code></pre></div></section><section><h3 id=propriétés-obligatoires-et-optionnelles>Propriétés obligatoires et optionnelles
<span><a href=#propri%c3%a9t%c3%a9s-obligatoires-et-optionnelles><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg></a></span></h3><ul><li>Une propriété est considérée comme optionnelle si elle peut contenir <code>null</code>. La colonne BD associée accepte les valeurs nulles.</li><li>L&rsquo;attribut <code>[Required]</code> permet de rendre obligatoire une propriété ayant un type référence (exemple : <code>string</code>).</li><li>L&rsquo;utilisation d&rsquo;un <a href=https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/builtin-types/nullable-value-types>type valeur nullable</a> (exemples : <code>int?</code>, <code>bool?</code>) rend la propriété optionnelle.</li></ul></section><section><h3 id=clés-primaires>Clés primaires
<span><a href=#cl%c3%a9s-primaires><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg></a></span></h3><ul><li>Une propriété nommée <code>Id</code> ou <code>{NomDeLaClasse}Id</code> est considérée comme clé primaire.</li><li>Par défaut, une stratégie d&rsquo;<a href="https://docs.microsoft.com/en-us/ef/core/modeling/generated-properties?tabs=data-annotations">auto-génération des valeurs</a> est utilisée.</li><li><a href="https://docs.microsoft.com/en-us/ef/core/modeling/keys?tabs=data-annotations">Plus de détails</a>.</li></ul></section><section><h3 id=mapping-des-associations>Mapping des associations
<span><a href=#mapping-des-associations><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg></a></span></h3><ul><li>Une propriété utilisant un type autre que scalaire est dite <strong>propriété de navigation</strong>.</li><li>La détection d&rsquo;une propriété de navigation entraine la création d&rsquo;une <strong>relation</strong> entre les deux classes impliquées.</li><li>Cette relation se traduit dans la base de données par la création d&rsquo;une <strong>clé étrangère</strong> dans la table associée à la classe dépendante (fille) de la relation.</li><li><a href=https://learn.microsoft.com/en-us/ef/core/modeling/relationships>Plus de détails</a>.</li></ul></section><section><h3 id=association-un-à-plusieurs>Association un-à-plusieurs
<span><a href=#association-un-%c3%a0-plusieurs><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg></a></span></h3><ul><li>Propriété de navigation de type collection dans la classe principale (mère).</li><li>Propriété de navigation et propriété de clé étrangère dans la classe dépendante (fille).</li></ul><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#fb660a;font-weight:700>public</span> <span style=color:#fb660a;font-weight:700>class</span> Blog
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#fb660a;font-weight:700>public</span> <span style=color:#cdcaa9;font-weight:700>int</span> Id { <span style=color:#fb660a;font-weight:700>get</span>; <span style=color:#fb660a;font-weight:700>set</span>; }
</span></span><span style=display:flex><span>    <span style=color:#080;background-color:#0f140f;font-style:italic>// ...</span>
</span></span><span style=display:flex><span>    <span style=color:#fb660a;font-weight:700>public</span> List&lt;Post&gt; Posts { <span style=color:#fb660a;font-weight:700>get</span>; <span style=color:#fb660a;font-weight:700>set</span>; } = <span style=color:#fb660a;font-weight:700>new</span> List&lt;Post&gt;();
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#fb660a;font-weight:700>public</span> <span style=color:#fb660a;font-weight:700>class</span> Post
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#fb660a;font-weight:700>public</span> <span style=color:#cdcaa9;font-weight:700>int</span> Id { <span style=color:#fb660a;font-weight:700>get</span>; <span style=color:#fb660a;font-weight:700>set</span>; }
</span></span><span style=display:flex><span>    <span style=color:#080;background-color:#0f140f;font-style:italic>// ...</span>
</span></span><span style=display:flex><span>    <span style=color:#fb660a;font-weight:700>public</span> <span style=color:#cdcaa9;font-weight:700>int</span> BlogId { <span style=color:#fb660a;font-weight:700>get</span>; <span style=color:#fb660a;font-weight:700>set</span>; } <span style=color:#080;background-color:#0f140f;font-style:italic>// FK</span>
</span></span><span style=display:flex><span>    <span style=color:#fb660a;font-weight:700>public</span> Blog Blog { <span style=color:#fb660a;font-weight:700>get</span>; <span style=color:#fb660a;font-weight:700>set</span>; } <span style=color:#080;background-color:#0f140f;font-style:italic>// Navigation</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></section><section><h3 id=association-un-à-un>Association un-à-un
<span><a href=#association-un-%c3%a0-un><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg></a></span></h3><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#fb660a;font-weight:700>public</span> <span style=color:#fb660a;font-weight:700>class</span> Blog
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#fb660a;font-weight:700>public</span> <span style=color:#cdcaa9;font-weight:700>int</span> Id { <span style=color:#fb660a;font-weight:700>get</span>; <span style=color:#fb660a;font-weight:700>set</span>; }
</span></span><span style=display:flex><span>    <span style=color:#080;background-color:#0f140f;font-style:italic>// ...</span>
</span></span><span style=display:flex><span>    <span style=color:#fb660a;font-weight:700>public</span> BlogImage BlogImage { <span style=color:#fb660a;font-weight:700>get</span>; <span style=color:#fb660a;font-weight:700>set</span>; }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#fb660a;font-weight:700>public</span> <span style=color:#fb660a;font-weight:700>class</span> BlogImage
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#fb660a;font-weight:700>public</span> <span style=color:#cdcaa9;font-weight:700>int</span> Id { <span style=color:#fb660a;font-weight:700>get</span>; <span style=color:#fb660a;font-weight:700>set</span>; }
</span></span><span style=display:flex><span>    <span style=color:#fb660a;font-weight:700>public</span> <span style=color:#cdcaa9;font-weight:700>byte</span>[] Image { <span style=color:#fb660a;font-weight:700>get</span>; <span style=color:#fb660a;font-weight:700>set</span>; }
</span></span><span style=display:flex><span>    <span style=color:#fb660a;font-weight:700>public</span> <span style=color:#cdcaa9;font-weight:700>string</span> Caption { <span style=color:#fb660a;font-weight:700>get</span>; <span style=color:#fb660a;font-weight:700>set</span>; }
</span></span><span style=display:flex><span>    <span style=color:#fb660a;font-weight:700>public</span> <span style=color:#cdcaa9;font-weight:700>int</span> BlogId { <span style=color:#fb660a;font-weight:700>get</span>; <span style=color:#fb660a;font-weight:700>set</span>; } <span style=color:#080;background-color:#0f140f;font-style:italic>// FK</span>
</span></span><span style=display:flex><span>    <span style=color:#fb660a;font-weight:700>public</span> Blog Blog { <span style=color:#fb660a;font-weight:700>get</span>; <span style=color:#fb660a;font-weight:700>set</span>; }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></section><section><h3 id=association-plusieurs-à-plusieurs>Association plusieurs-à-plusieurs
<span><a href=#association-plusieurs-%c3%a0-plusieurs><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg></a></span></h3><p>Entraîne la création d&rsquo;une table de jointure contenant deux clés étrangères dans la base de données.</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#fb660a;font-weight:700>public</span> <span style=color:#fb660a;font-weight:700>class</span> Post
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#fb660a;font-weight:700>public</span> <span style=color:#cdcaa9;font-weight:700>int</span> Id { <span style=color:#fb660a;font-weight:700>get</span>; <span style=color:#fb660a;font-weight:700>set</span>; }
</span></span><span style=display:flex><span>    <span style=color:#080;background-color:#0f140f;font-style:italic>// ...</span>
</span></span><span style=display:flex><span>    <span style=color:#fb660a;font-weight:700>public</span> ICollection&lt;Tag&gt; Tags { <span style=color:#fb660a;font-weight:700>get</span>; <span style=color:#fb660a;font-weight:700>set</span>; }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#fb660a;font-weight:700>public</span> <span style=color:#fb660a;font-weight:700>class</span> Tag
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#fb660a;font-weight:700>public</span> <span style=color:#cdcaa9;font-weight:700>string</span> Id { <span style=color:#fb660a;font-weight:700>get</span>; <span style=color:#fb660a;font-weight:700>set</span>; }
</span></span><span style=display:flex><span>    <span style=color:#fb660a;font-weight:700>public</span> ICollection&lt;Post&gt; Posts { <span style=color:#fb660a;font-weight:700>get</span>; <span style=color:#fb660a;font-weight:700>set</span>; }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></section><section><h3 id=chargement-des-associations>Chargement des Associations
<span><a href=#chargement-des-associations><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg></a></span></h3><ul><li>Les méthodes <code>.Include()</code> et <code>.ThenInclude()</code> permettent de spécifier les données associées à inclure dans les résultats d&rsquo;une requête.</li><li>Ce mécanisme est appelé <a href=https://docs.microsoft.com/en-us/ef/core/querying/related-data/eager>chargement hâtif</a> (<em>eager loading</em>).</li></ul><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#fb660a;font-weight:700>using</span> (<span style=color:#cdcaa9;font-weight:700>var</span> context = <span style=color:#fb660a;font-weight:700>new</span> BloggingContext())
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#080;background-color:#0f140f;font-style:italic>// Load posts for each blog</span>
</span></span><span style=display:flex><span>    <span style=color:#080;background-color:#0f140f;font-style:italic>// Uncomment the .ThenInclude line to load post author</span>
</span></span><span style=display:flex><span>    <span style=color:#cdcaa9;font-weight:700>var</span> blogs = context.Blogs
</span></span><span style=display:flex><span>        .Include(blog =&gt; blog.Posts)
</span></span><span style=display:flex><span>        <span style=color:#080;background-color:#0f140f;font-style:italic>// .ThenInclude(post =&gt; post.Author)</span>
</span></span><span style=display:flex><span>        .ToList();
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></section><section><h3 id=mapping-de-lhéritage>Mapping de l&rsquo;héritage
<span><a href=#mapping-de-lh%c3%a9ritage><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg></a></span></h3><ul><li>Problème épineux : les SGBDR ne supportent pas le concept d’héritage.</li><li>Plusieurs stratégies possibles, avec chacune des avantages et des inconvénients :<ul><li>une table pour toute la hiérarchie (TPH) ;</li><li>une table par classe concrète (TPC) ;</li><li>une table par type (TPT).</li></ul></li><li>Le choix dépend du contexte. Donnée-clé : nombre de propriétés communes.</li><li><a href=https://learn.microsoft.com/en-us/ef/core/modeling/inheritance>Plus de détails</a>.</li></ul></section><section><h3 id=la-stratégie-tph-avec-ef-core>La stratégie TPH avec EF Core
<span><a href=#la-strat%c3%a9gie-tph-avec-ef-core><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg></a></span></h3><ul><li>Solution par défaut (souvent la plus simple).</li><li>Ajoute à l&rsquo;unique table qui mappe la hiérarchie :<ul><li>une colonne par propriété de chacune des classes de la hiérarchie ;</li><li>une colonne <code>Discriminator</code> qui détermine le type concret de l&rsquo;objet stocké en BD.</li></ul></li></ul></section><section><h3 id=exemple-de-mapping-de-lhéritage>Exemple de mapping de l&rsquo;héritage
<span><a href=#exemple-de-mapping-de-lh%c3%a9ritage><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg></a></span></h3><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#fb660a;font-weight:700>internal</span> <span style=color:#fb660a;font-weight:700>class</span> BloggingContext : DbContext
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#fb660a;font-weight:700>public</span> DbSet&lt;Blog&gt; Blogs { <span style=color:#fb660a;font-weight:700>get</span>; <span style=color:#fb660a;font-weight:700>set</span>; }
</span></span><span style=display:flex><span>    <span style=color:#fb660a;font-weight:700>public</span> DbSet&lt;RssBlog&gt; RssBlogs { <span style=color:#fb660a;font-weight:700>get</span>; <span style=color:#fb660a;font-weight:700>set</span>; }
</span></span><span style=display:flex><span>    <span style=color:#080;background-color:#0f140f;font-style:italic>// ...</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#fb660a;font-weight:700>public</span> <span style=color:#fb660a;font-weight:700>class</span> Blog
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#fb660a;font-weight:700>public</span> <span style=color:#cdcaa9;font-weight:700>int</span> BlogId { <span style=color:#fb660a;font-weight:700>get</span>; <span style=color:#fb660a;font-weight:700>set</span>; }
</span></span><span style=display:flex><span>    <span style=color:#080;background-color:#0f140f;font-style:italic>// ...</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#fb660a;font-weight:700>public</span> <span style=color:#fb660a;font-weight:700>class</span> RssBlog : Blog
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#fb660a;font-weight:700>public</span> <span style=color:#cdcaa9;font-weight:700>string</span> RssUrl { <span style=color:#fb660a;font-weight:700>get</span>; <span style=color:#fb660a;font-weight:700>set</span>; }
</span></span><span style=display:flex><span>    <span style=color:#080;background-color:#0f140f;font-style:italic>// ...</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></section><section><h3 id=schéma-bd-après-migration>Schéma BD après migration
<span><a href=#sch%c3%a9ma-bd-apr%c3%a8s-migration><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg></a></span></h3><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>dotnet ef migrations add RssBlog
</span></span><span style=display:flex><span>dotnet ef database update
</span></span></code></pre></div><p><img src=images/efcore_tph_tables.png alt="Stratégie TPH - Tables"></p><p><img src=images/inheritance-tph-data.png alt="Stratégie YPH - Enregistrements"></p></section></div></div><div><a href=https://ensc.bordeaux-inp.fr><img src=https://www.bpesquet.fr/images/ENSC_2022.jpg style=position:absolute;bottom:10px;left:10px></a></div><script src=https://www.bpesquet.fr/reveal.js/dist/reveal.js></script>
<script src=https://www.bpesquet.fr/reveal.js/plugin/math/math.js></script>
<script>Reveal.initialize({history:!1,slideNumber:!0,transition:"convex",math:{mathjax:"https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js",config:"TeX-MML-AM_HTMLorMML"},dependencies:[{src:"https://www.bpesquet.fr/reveal.js/plugin/markdown/marked.js"},{src:"https://www.bpesquet.fr/reveal.js/plugin/markdown/markdown.js"},{src:"https://www.bpesquet.fr/reveal.js/plugin/notes/notes.js",async:!0},{src:"https://www.bpesquet.fr/reveal.js/plugin/zoom-js/zoom.js",async:!0},{src:"https://www.bpesquet.fr/reveal.js/plugin/highlight/highlight.js",async:!0,callback:function(){hljs.initHighlightingOnLoad()}}],plugins:[RevealMath]})</script></body></html>